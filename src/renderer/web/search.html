<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<!-- <meta name="generator" content="mze" /> -->
		<title>mze</title>
		<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<style>

.search_bar {
	display: flex;
	justify-content: center;
}

.search_bar .search_box {
	max-width: 30em;
	flex: 100px;
}

.search_box {
	font-size: 2em;
}

.search_results {
	display: flex;
}

article.search_result {
	section.info {
	}

	section.tags {
	}

	section.attributes {
	}

	section.record_data {
	}

	section.link_from_to {
	}
}

</style>
<script>

const search_url = "/search";

window.addEventListener("load", (e) => {
	const search_box = document.getElementsByClassName("search_box")[0];
	search_box.addEventListener("input", updateSearchResults);
	updateSearchResults(e);
});

// TODO handle concurrent queries properly by cancelling the in-progress search
// and executing a new one
async function updateSearchResults(e) {
	const search_box = document.getElementsByClassName("search_box")[0];
	const search_results = document.getElementsByClassName("search_results")[0];

	const search_params = new URLSearchParams({
		q: search_box.value,
	});
	const url = search_url + "?" + search_params.toString();
	console.log("123");
	try {
		const response = await fetch(url);
		if (!response.ok) {
			console.error(`Error: url=${url} response.status=${response.status}`);
		}
		search_results.innerHTML = await response.text();
	} catch (error) {
		console.error(`Error: error.message=${error.message}`);
	}
}

</script>
	</head>
	<body>
		<nav>
		</nav>
		<main>
			<div class="search_bar">
				<input type="text" class="search_box">
			</div>
			<div class="search_interpretation">
				<!-- how mze interprets the search query -->
			</div>
			<div class="search_results">
			</div>
		</main>
	</body>
</html>
